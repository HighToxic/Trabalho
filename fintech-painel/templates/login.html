<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Login - SafeBankTech</title>
    <!-- 1. Link para o seu arquivo style.css -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <div class="login-container">
        <!-- Wrapper para centralizar o conte√∫do e manter a largura -->
        <div class="login-box-wrapper">

            <!-- 2. Bloco de Mensagens Flash (para feedback do bot√£o) -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <!-- Mapeia a categoria (success, warning) para a classe CSS -->
                        {% set css_class = 'flash-warning' if category == 'warning' else 'flash-success' %}
                        <div class="flash-msg {{ css_class }}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <!-- 3. Sua Caixa de Login Original -->
            <div class="login-box">
                <h2>üîê SafeBankTech</h2>
                <p class="login-subtitle">Painel administrativo</p>

                <!-- Exibe o erro de 'Usu√°rio ou senha inv√°lidos!' -->
                {% if erro %}
                    <div class="erro-msg">{{ erro }}</div>
                {% endif %}

                <!-- 
                  Seu formul√°rio de login. 
                  Adicionei a 'action' para garantir que ele envie para a rota certa.
                -->
                <form method="POST" action="{{ url_for('login') }}">
                    <div class="input-group">
                        <input type="text" name="usuario" placeholder="Usu√°rio" required>
                    </div>
                    <div class="input-group">
                        <input type="password" name="senha" placeholder="Senha" required>
                    </div>
                    <button type="submit" class="btn-primary full-width">Entrar</button>
                </form>
            </div>

            <!-- 4. Novo Painel de Controle de Seguran√ßa -->
            <div class="security-box">
                <p>
                    Modo Atual: 
                    <!-- L√™ a vari√°vel da sess√£o para mostrar o modo -->
                    {% if session.security_mode == 'inseguro' %}
                        <span class="mode-inseguro">Inseguro (Vulner√°vel a SQLi)</span>
                    {% else %}
                        <span class="mode-seguro">Seguro (Protegido)</span>
                    {% endif %}
                </p>
                
                <!-- Novo formul√°rio S√ì para o bot√£o de alternar -->
                <form action="{{ url_for('toggle_mode') }}" method="POST">
                    <button type="submit" class="btn-secondary full-width">
                        Alternar Modo de Seguran√ßa
                    </button>
                </form>

                <!-- Caixa de instru√ß√µes para o teste -->
                <div class="info-box">
                    <strong>Como testar (em Modo Inseguro):</strong>
                    <p>1. No campo "Usu√°rio", digite:<br> <code>admin' --</code></p>
                    <p>2. Na "Senha" escreva qualquer coisa.</p>
                </div>
            </div>

        </div> <!-- Fim do .login-box-wrapper -->
    </div>
</body>
</html>
